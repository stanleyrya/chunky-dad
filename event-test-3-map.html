<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Map - Chunky Dad</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body {
            background: #f5f5f5;
            font-family: 'Inter', sans-serif;
        }
        .test-header {
            text-align: center;
            padding: 2rem 1rem;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1000;
        }
        .test-header h1 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        .back-link {
            color: var(--secondary-color);
            text-decoration: none;
            margin-bottom: 1rem;
            display: inline-block;
        }
        .map-container {
            position: relative;
            height: calc(100vh - 150px);
            width: 100%;
        }
        #eventMap {
            height: 100%;
            width: 100%;
        }
        .event-sidebar {
            position: absolute;
            left: 20px;
            top: 20px;
            bottom: 20px;
            width: 350px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }
        .event-sidebar.collapsed {
            transform: translateX(-320px);
        }
        .sidebar-toggle {
            position: absolute;
            right: -20px;
            top: 20px;
            background: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 0 8px 8px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .sidebar-toggle:hover {
            background: var(--secondary-color);
        }
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        .sidebar-header h2 {
            color: var(--primary-color);
            font-size: 1.25rem;
            margin: 0;
        }
        .event-list {
            padding: 1rem;
        }
        .event-item {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .event-item:hover {
            background: #f8f8f8;
            border-color: var(--primary-color);
        }
        .event-item.active {
            background: #f0f8ff;
            border-color: var(--primary-color);
        }
        .event-item-date {
            color: var(--primary-color);
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .event-item-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
            margin: 0.25rem 0;
        }
        .event-item-venue {
            color: #666;
            font-size: 0.9rem;
        }
        .custom-marker {
            background: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50% 50% 50% 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            transform: rotate(-45deg);
            position: relative;
        }
        .custom-marker span {
            transform: rotate(45deg);
        }
        .leaflet-popup-content-wrapper {
            border-radius: 12px;
            padding: 0;
            overflow: hidden;
        }
        .popup-content {
            padding: 1.5rem;
            min-width: 250px;
        }
        .popup-header {
            background: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            margin: -1.5rem -1.5rem 1rem;
        }
        .popup-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin: 0;
        }
        .popup-date {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .popup-venue {
            color: #666;
            margin-bottom: 0.75rem;
        }
        .popup-description {
            color: #555;
            line-height: 1.5;
        }
        @media (max-width: 768px) {
            .event-sidebar {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
                bottom: auto;
                height: 40vh;
                top: auto;
                bottom: 20px;
            }
            .event-sidebar.collapsed {
                transform: translateY(calc(100% - 60px));
            }
            .sidebar-toggle {
                right: 50%;
                transform: translateX(50%);
                top: -20px;
                width: 60px;
                border-radius: 8px 8px 0 0;
            }
        }
    </style>
</head>
<body>
    <div class="test-header">
        <a href="event-test-index.html" class="back-link">‚Üê Back to all variations</a>
        <h1>Map Integration</h1>
        <p>Interactive map showing event locations</p>
    </div>

    <div class="map-container">
        <div id="eventMap"></div>
        <div class="event-sidebar" id="sidebar">
            <div class="sidebar-toggle" onclick="toggleSidebar()">
                <span id="toggleIcon">‚Äπ</span>
            </div>
            <div class="sidebar-header">
                <h2>Upcoming Events</h2>
            </div>
            <div class="event-list" id="eventList">
                <!-- Events will be populated here -->
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Sample event data with coordinates
        const events = [
            {
                id: 1,
                title: "Bear Week Pool Party",
                date: "Saturday, March 15",
                venue: "Wet Bear Pool Club",
                description: "Join us for the biggest pool party of the season with DJ Thunder spinning all day.",
                icon: "üèä",
                lat: 40.7589,
                lng: -73.9851
            },
            {
                id: 2,
                title: "Leather & Lace Night",
                date: "Friday, March 21", 
                venue: "The Den Bar",
                description: "Dress code strictly enforced. Prizes for best outfit. Happy hour until 10pm.",
                icon: "üé≠",
                lat: 40.7614,
                lng: -73.9776
            },
            {
                id: 3,
                title: "Sunday Beer Bust",
                date: "Sunday, March 23",
                venue: "Growler's Pub",
                description: "All you can drink beer from 3-8pm. BBQ on the patio starting at 4pm.",
                icon: "üç∫",
                lat: 40.7549,
                lng: -73.9840
            },
            {
                id: 4,
                title: "Trivia Night",
                date: "Wednesday, March 26",
                venue: "Smart Bear Cafe", 
                description: "Test your knowledge and win prizes. Teams of up to 6 people. Free entry.",
                icon: "üß†",
                lat: 40.7580,
                lng: -73.9855
            },
            {
                id: 5,
                title: "Karaoke Thursdays",
                date: "Thursday, March 27",
                venue: "Honey's Lounge",
                description: "Show off your vocal skills or just come to cheer. Half price drinks for singers.",
                icon: "üé§",
                lat: 40.7629,
                lng: -73.9820
            },
            {
                id: 6,
                title: "Dance Party: Retro Night",
                date: "Saturday, March 29",
                venue: "Club Furr",
                description: "80s and 90s hits all night long. Costume contest at midnight.",
                icon: "üï∫",
                lat: 40.7560,
                lng: -73.9800
            }
        ];

        let map;
        let markers = [];

        function initMap() {
            // Initialize map centered on Manhattan
            map = L.map('eventMap').setView([40.7589, -73.9851], 14);
            
            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);
            
            // Add custom markers for each event
            events.forEach(event => {
                const customIcon = L.divIcon({
                    html: `<div class="custom-marker"><span>${event.icon}</span></div>`,
                    iconSize: [40, 40],
                    iconAnchor: [20, 40],
                    popupAnchor: [0, -40],
                    className: ''
                });
                
                const marker = L.marker([event.lat, event.lng], { icon: customIcon })
                    .addTo(map);
                
                // Create popup content
                const popupContent = `
                    <div class="popup-content">
                        <div class="popup-header">
                            <h3 class="popup-title">${event.title}</h3>
                            <div class="popup-date">${event.date}</div>
                        </div>
                        <div class="popup-venue">üìç ${event.venue}</div>
                        <div class="popup-description">${event.description}</div>
                    </div>
                `;
                
                marker.bindPopup(popupContent, {
                    maxWidth: 300,
                    className: 'custom-popup'
                });
                
                marker.eventId = event.id;
                markers.push(marker);
            });
            
            // Populate sidebar
            populateSidebar();
        }

        function populateSidebar() {
            const eventList = document.getElementById('eventList');
            
            events.forEach(event => {
                const eventItem = document.createElement('div');
                eventItem.className = 'event-item';
                eventItem.innerHTML = `
                    <div class="event-item-date">${event.date}</div>
                    <h3 class="event-item-title">${event.icon} ${event.title}</h3>
                    <div class="event-item-venue">üìç ${event.venue}</div>
                `;
                
                eventItem.onclick = () => {
                    // Remove active class from all items
                    document.querySelectorAll('.event-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    eventItem.classList.add('active');
                    
                    // Center map on event and open popup
                    const marker = markers.find(m => m.eventId === event.id);
                    if (marker) {
                        map.setView([event.lat, event.lng], 16);
                        marker.openPopup();
                    }
                };
                
                eventList.appendChild(eventItem);
            });
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const icon = document.getElementById('toggleIcon');
            
            sidebar.classList.toggle('collapsed');
            icon.textContent = sidebar.classList.contains('collapsed') ? '‚Ä∫' : '‚Äπ';
        }

        // Initialize map on load
        initMap();
    </script>
</body>
</html>