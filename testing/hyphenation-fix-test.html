<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyphenation Fix Test - Chunky Dad</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1rem;
        }
        .test-case {
            background: var(--background-light);
            border: 1px solid var(--border-lighter);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .test-result {
            background: var(--background-darker);
            padding: 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸ”§ Hyphenation Logic Fix Test</h1>
        <p>Testing the improved hyphenation logic that properly splits long words at hyphen positions.</p>
        
        <div class="test-case">
            <h3>Test Case 1: Long hyphenated word that should split</h3>
            <p><strong>Input:</strong> "Super-long-hyphenated-word-that-exceeds-limit"</p>
            <p><strong>Character Limit:</strong> 15</p>
            <div class="test-result" id="test1-result">Loading...</div>
        </div>
        
        <div class="test-case">
            <h3>Test Case 2: Multiple long hyphenated words</h3>
            <p><strong>Input:</strong> "Bear-weekend party-celebration mega-event"</p>
            <p><strong>Character Limit:</strong> 20</p>
            <div class="test-result" id="test2-result">Loading...</div>
        </div>
        
        <div class="test-case">
            <h3>Test Case 3: Word with escaped hyphen (should preserve)</h3>
            <p><strong>Input:</strong> "Co\-op Bears super-long-name"</p>
            <p><strong>Character Limit:</strong> 15</p>
            <div class="test-result" id="test3-result">Loading...</div>
        </div>
        
        <div class="test-case">
            <h3>Test Case 4: Normal word that fits</h3>
            <p><strong>Input:</strong> "Regular event name"</p>
            <p><strong>Character Limit:</strong> 20</p>
            <div class="test-result" id="test4-result">Loading...</div>
        </div>
    </div>

    <script src="../js/logger.js"></script>
    <script src="../js/calendar-core.js"></script>
    <script src="../js/dynamic-calendar-loader.js"></script>
    <script>
        // Initialize logger
        window.logger = new Logger();
        
        // Create a test instance of the calendar loader
        const calendarLoader = new DynamicCalendarLoader();
        
        // Test cases
        const testCases = [
            {
                id: 'test1-result',
                shortName: 'Super-long-hyphenated-word-that-exceeds-limit',
                charLimit: 15,
                expected: 'Should split at hyphens'
            },
            {
                id: 'test2-result', 
                shortName: 'Bear-weekend party-celebration mega-event',
                charLimit: 20,
                expected: 'Should handle multiple hyphenated words'
            },
            {
                id: 'test3-result',
                shortName: 'Co\\-op Bears super-long-name', 
                charLimit: 15,
                expected: 'Should preserve escaped hyphen'
            },
            {
                id: 'test4-result',
                shortName: 'Regular event name',
                charLimit: 20,
                expected: 'Should return as-is since it fits'
            }
        ];
        
        // Run tests
        testCases.forEach(testCase => {
            try {
                // Create a mock event object
                const mockEvent = {
                    name: 'Test Event',
                    shortName: testCase.shortName
                };
                
                // Test the character limits for different breakpoints
                const charLimitsPerLine = {
                    xs: testCase.charLimit,
                    sm: testCase.charLimit + 5,
                    md: testCase.charLimit + 10,
                    lg: testCase.charLimit + 15,
                    xl: testCase.charLimit + 20
                };
                
                // Call the smart event name method with xs breakpoint
                const result = calendarLoader.getSmartEventNameForBreakpoint(mockEvent, 'xs', charLimitsPerLine);
                
                const resultElement = document.getElementById(testCase.id);
                resultElement.innerHTML = `
                    <strong>Result:</strong> "${result}"<br>
                    <strong>Length:</strong> ${result.length} characters<br>
                    <strong>Expected:</strong> ${testCase.expected}
                `;
                
                logger.info('TEST', `Test case completed`, {
                    input: testCase.shortName,
                    result: result,
                    charLimit: testCase.charLimit
                });
                
            } catch (error) {
                const resultElement = document.getElementById(testCase.id);
                resultElement.innerHTML = `<strong>Error:</strong> ${error.message}`;
                resultElement.style.color = 'red';
                
                logger.error('TEST', `Test case failed`, error);
            }
        });
    </script>
</body>
</html>