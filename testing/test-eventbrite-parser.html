<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventbrite Parser Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .header {
            background: #333;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .sample-html {
            background: #f8f8f8;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .results {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
        }
        
        .error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }
        
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 10px 10px 0;
        }
        
        button:hover {
            background: #005a87;
        }
        
        .event-details {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .event-link {
            color: #007cba;
            text-decoration: none;
            font-weight: bold;
        }
        
        .event-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🎫 Eventbrite Parser Test</h1>
        <p>Test the new EventbriteEventParser with the provided HTML sample</p>
    </div>
    
    <div class="test-section">
        <h3>Sample HTML (Megawoof Event from Eventbrite)</h3>
        <div class="sample-html" id="sampleHtml">
            <!-- The sample HTML will be inserted here -->
        </div>
        
        <button onclick="testParser()">Test Eventbrite Parser</button>
        <button onclick="clearResults()">Clear Results</button>
        
        <div id="results"></div>
    </div>
    
    <!-- Load the eventbrite parser -->
    <script src="../scripts/core/event-parser-eventbrite.js"></script>
    
    <script>
        // The provided HTML sample
        const sampleHtml = `<div class="Container_root__4i85v NestedActionContainer_root__1jtfr event-card event-card__vertical" style="--ContainerBgColor: #fff; --ContainerBorderRadius: 16px; --ContainerElevationFocusWithin: 0px 2px 8px rgba(30, 10, 60, 0.06), 0px 4px 12px rgba(30, 10, 60, 0.08); --ContainerElevationHover: 0px 2px 8px rgba(30, 10, 60, 0.06), 0px 4px 12px rgba(30, 10, 60, 0.08);"><div data-testid="event-card-tracking-layer" style="position: absolute; top: 0px; left: 0px; height: 100%; pointer-events: none; width: 100%;"></div><a href="https://www.eventbrite.com/e/megawoof-america-denver-massive-2-parties-1-ticket-tickets-1381219547849?aff=ebdsoporgprofile" rel="noopener" target="_blank" class="event-card-link " aria-label="View MEGAWOOF AMERICA DENVER  : MASSIVE 2 Parties 1 Ticket" data-event-id="1381219547849" data-event-paid-status="paid" data-event-location="Denver, CO" data-event-category="community"><div class="event-card-image__aspect-container" data-testid="event-card-image-container" style="--image-aspect-ratio: 2; --image-aspect-ratio-mobile: 2; --image-width: 100%; --image-width-mobile: 100%; --image-background-color: #231d1b;"><img height="256" width="512" class="event-card-image" src="https://img.evbuc.com/https%3A%2F%2Fcdn.evbuc.com%2Fimages%2F1042921273%2F185013722403%2F1%2Foriginal.20250531-143913?crop=focalpoint&amp;fit=crop&amp;auto=format%2Ccompress&amp;q=75&amp;sharp=10&amp;fp-x=0.005&amp;fp-y=0.005&amp;s=b37e8fdbdbd0f2e9cf130e8f23f20acf" loading="eager" alt="MEGAWOOF AMERICA DENVER  : MASSIVE 2 Parties 1 Ticket primary image" fetchpriority="high"></div></a><section class="event-card-details" style="--EventCardDetailsPadding: 16px 8px 12px 12px; --EventCardDetailsFlexGrow: 2; --EventCardDetailsPosition: relative;"><div class="Stack_root__1ksk7" style="--Space: 4px;"><h3 class="Typography_root__487rx #3a3247 Typography_body-lg__487rx event-card__clamp-line--two Typography_align-match-parent__487rx" style="--TypographyColor: #3a3247;">MEGAWOOF AMERICA DENVER  : MASSIVE 2 Parties 1 Ticket</h3><p class="Typography_root__487rx #585163 Typography_body-md__487rx event-card__clamp-line--one Typography_align-match-parent__487rx" style="--TypographyColor: #585163;">Sat, Aug 23 •  9:00 PM </p><p class="Typography_root__487rx #585163 Typography_body-md__487rx event-card__clamp-line--one Typography_align-match-parent__487rx" style="--TypographyColor: #585163;">Trade</p><p class="Typography_root__487rx #3a3247 Typography_body-md-bold__487rx Typography_align-match-parent__487rx" style="--TypographyColor: #3a3247;">From $16.84</p><section class="event-card-actions" data-event-id="1381219547849" data-event-paid-status="paid" style="--EventCardActionsPosition: absolute; --EventCardActionsTop: -22px; --EventCardActionsRight: 8px; --EventCardActionsGap: 8px;" data-event-location="Denver, CO" data-event-category="community"><span class="eds-icon-button eds-icon-button--outline" data-spec="icon-button"><button data-event-id="1381219547849" class="eds-btn--button eds-btn--none eds-btn--icon-only" type="button" aria-pressed="false"><i class="eds-vector-image eds-icon--small eds-vector-image--grey-700 eds-vector-image--block" title="" data-spec="icon" data-testid="icon"><svg id="heart-chunky_svg__eds-icon--user-chunky_svg" x="0" y="0" viewBox="0 0 24 24" xml:space="preserve"><path id="heart-chunky_svg__eds-icon--heart-chunky_base" fill-rule="evenodd" clip-rule="evenodd" d="M18.8 6.2C18.1 5.4 17 5 16 5c-1 0-2 .4-2.8 1.2L12 7.4l-1.2-1.2C10 5.4 9 5 8 5c-1 0-2 .4-2.8 1.2-1.5 1.6-1.5 4.2 0 5.8l6.8 7 6.8-7c1.6-1.6 1.6-4.2 0-5.8zm-1.4 4.4L12 16.1l-5.4-5.5c-.8-.8-.8-2.2 0-3C7 7.2 7.5 7 8 7c.5 0 1 .2 1.4.6l2.6 2.7 2.7-2.7c.3-.4.8-.6 1.3-.6s1 .2 1.4.6c.8.8.8 2.2 0 3z"></path></svg><span class="eds-is-hidden-accessible">Save this event: MEGAWOOF AMERICA DENVER  : MASSIVE 2 Parties 1 Ticket</span></i></button></span><span class="eds-icon-button eds-icon-button--outline" data-spec="icon-button"><button class="eds-btn--button eds-btn--none eds-btn--icon-only" type="button"><i class="eds-vector-image eds-icon--small eds-vector-image--block" title="" data-spec="icon" data-testid="icon"><svg id="share-ios-chunky_svg__eds-icon--share-ios-chunky_svg" x="0" y="0" viewBox="0 0 24 24" xml:space="preserve"><path id="share-ios-chunky_svg__eds-icon--share-ios-chunky_base" fill-rule="evenodd" clip-rule="evenodd" d="M18 16v2H6v-2H4v4h16v-4z"></path><path id="share-ios-chunky_svg__eds-icon--share-ios-chunky_arrow" fill-rule="evenodd" clip-rule="evenodd" d="M12 4L7 9l1.4 1.4L11 7.8V16h2V7.8l2.6 2.6L17 9l-5-5z"></path></svg><span class="eds-is-hidden-accessible">Share this event: MEGAWOOF AMERICA DENVER  : MASSIVE 2 Parties 1 Ticket</span></i></button></span></section></div></section></div>`;
        
        // Display the sample HTML
        document.getElementById('sampleHtml').textContent = sampleHtml;
        
        function testParser() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Testing parser...</p>';
            
            try {
                // Check if EventbriteEventParser is loaded
                if (typeof EventbriteEventParser === 'undefined') {
                    throw new Error('EventbriteEventParser is not loaded');
                }
                
                // Create parser instance
                const parser = new EventbriteEventParser();
                
                // Create mock HTML data
                const htmlData = {
                    html: sampleHtml,
                    url: 'https://www.eventbrite.com/o/megawoof-america-18118978189'
                };
                
                // Parse the events
                const result = parser.parseEvents(htmlData);
                
                // Display results
                let resultHtml = '<div class="results"><h4>✅ Parser Test Results</h4>';
                
                if (result.events && result.events.length > 0) {
                    const event = result.events[0];
                    resultHtml += `
                        <div class="event-details">
                            <h5>📅 Parsed Event:</h5>
                            <p><strong>Title:</strong> ${event.title || 'N/A'}</p>
                            <p><strong>Date String:</strong> ${event.dateString || 'N/A'}</p>
                            <p><strong>Start Date (ISO):</strong> ${event.startDate || event.date || 'N/A'}</p>
                            <p><strong>End Date (ISO):</strong> ${event.endDate || 'N/A'}</p>
                            <p><strong>Venue/Bar Name:</strong> ${event.venue || 'N/A'}</p>
                            <p><strong>Address:</strong> ${event.address || 'N/A'}</p>
                            <p><strong>GPS Coordinates:</strong> ${event.coordinates ? `${event.coordinates.lat}, ${event.coordinates.lng}` : 'N/A'}</p>
                            <p><strong>Google Maps Link:</strong> ${event.googleMapsLink ? `<a href="${event.googleMapsLink}" target="_blank" class="event-link">🗺️ Open in Maps</a>` : 'N/A'}</p>
                            <p><strong>City:</strong> ${event.city || 'N/A'}</p>
                            <p><strong>Price:</strong> ${event.price || 'N/A'}</p>
                            <p><strong>Is Bear Event:</strong> ${event.isBearEvent ? '🐻 Yes' : '❌ No'}</p>
                            <p><strong>Event URL:</strong> ${event.eventUrl ? `<a href="${event.eventUrl}" target="_blank" class="event-link">${event.eventUrl}</a>` : 'N/A'}</p>
                        </div>
                    `;
                    
                    // Check if the expected URL is extracted
                    const expectedUrl = 'https://www.eventbrite.com/e/megawoof-america-denver-massive-2-parties-1-ticket-tickets-1381219547849';
                    if (event.eventUrl && event.eventUrl.includes('1381219547849')) {
                        resultHtml += '<p style="color: green; font-weight: bold;">✅ SUCCESS: Correct event URL extracted!</p>';
                    } else {
                        resultHtml += '<p style="color: red; font-weight: bold;">❌ ISSUE: Expected URL not found or incorrect</p>';
                        resultHtml += `<p>Expected URL pattern: ${expectedUrl}</p>`;
                    }
                } else {
                    resultHtml += '<p style="color: red;">❌ No events parsed from the HTML sample</p>';
                }
                
                resultHtml += `
                    <p><strong>Additional Links Found:</strong> ${result.additionalLinks ? result.additionalLinks.length : 0}</p>
                    <p><strong>Source:</strong> ${result.source}</p>
                </div>`;
                
                resultsDiv.innerHTML = resultHtml;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="results error">
                    <h4>❌ Parser Test Failed</h4>
                    <p><strong>Error:</strong> ${error.message}</p>
                    <p><strong>Stack:</strong> ${error.stack}</p>
                </div>`;
            }
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
        
        // Auto-run test when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Eventbrite Parser Test Ready');
            testParser(); // Auto-run the test
        });
    </script>
</body>
</html>